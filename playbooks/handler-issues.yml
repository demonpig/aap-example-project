---

- name: Test
  hosts: all
  gather_facts: false
  strategy: "{{ strategy | default('linear') }}"

  handlers:
    - name: HANDLER
      changed_when: true
      ansible.builtin.debug:
        msg: "HANDLER"

  tasks:
    - name: TASK
      notify: HANDLER
      changed_when: True if inventory_hostname == changed_host else False
      failed_when: True if inventory_hostname == failed_host else False
      ansible.builtin.debug:
        msg: "TASK"

  post_tasks:
    - name: POST_TASK
      ansible.builtin.debug:
        msg: "POST_TASK"
